-- increase display order
UPDATE TENJIN_SYLLABUSELEMENTMAPPING SET DISPLAY_ORDER = DISPLAY_ORDER+1, EQUALS_PUBLISHED = 0 WHERE SYLLABUSELEMENT_ID IN 
(SELECT tse.SYLLABUSELEMENT_ID 
FROM tenjin_syllabuselement tse, tenjin_syllabuselement tsp, TENJIN_SYLLABUSELEMENTMAPPING ts, TENJIN_SYLLABUS ts3 
WHERE tsp.SYLLABUSELEMENT_ID NOT IN (SELECT PARENT_ID FROM TENJIN_SYLLABUSELEMENT ts2 where ts2.TEMPLATESTRUCTURE_ID = 693)
AND tsp.TEMPLATESTRUCTURE_ID = 12
AND tsp.SITE_ID IN ('RHRT30303.A2020','TECH30714.A2020','RHRT30323.A2020','RHRT30320.A2020','FINA30221.A2020','DDRS30515.A2020','ENTR31036.A2020','ENTR31027.A2020','TECH30715.A2020','TECH30718.A2020','ENTR31031.A2020','TECH30719.A2020','MARK30118.A2020','TECH30790.A2020','TECH30723.A2020','TECH30607.A2020','FINA50200.A2020','COMP30904.A2020','MATH30603.A2020','ENTR31036.A2020','LANG91504.A2020')
AND tsp.SYLLABUSELEMENT_ID = ts.SYLLABUSELEMENT_ID 
AND ts.SYLLABUS_ID = ts3.SYLLABUS_ID 
AND ts3.DELETED = 0
AND tse.PARENT_ID = tsp.SYLLABUSELEMENT_ID);

-- insert new rubric
INSERT INTO TENJIN_SYLLABUSELEMENT (SYLLABUSELEMENT_ID, CLASS_TYPE, TEMPLATESTRUCTURE_ID, PROVIDER_ID, COMMON, EQUALS_PUBLISHED, CREATED_DATE, CREATED_BY, LAST_MODIFIED_DATE, LAST_MODIFIED_BY, TITLE, SITE_ID, PARENT_ID) 
(SELECT syllabuselement_id_seq.nextval, 'ca.hec.tenjin.api.model.syllabus.SyllabusRubricElement', 693, 2, 1, 0, SYSDATE, 'cvo_admin_insert_plagiat', SYSDATE, 'cvo_admin_insert_plagiat', 'IMPORTANT', ts.SITE_ID, ts.SYLLABUSELEMENT_ID 
FROM TENJIN_SYLLABUSELEMENT ts
WHERE ts.TEMPLATESTRUCTURE_ID = 12
AND ts.SYLLABUSELEMENT_ID NOT IN (SELECT PARENT_ID FROM TENJIN_SYLLABUSELEMENT ts2 WHERE ts2.TEMPLATESTRUCTURE_ID = 693)
AND ts.SITE_ID IN ('RHRT30303.A2020','TECH30714.A2020','RHRT30323.A2020','RHRT30320.A2020','FINA30221.A2020','DDRS30515.A2020','ENTR31036.A2020','ENTR31027.A2020','TECH30715.A2020','TECH30718.A2020','ENTR31031.A2020','TECH30719.A2020','MARK30118.A2020','TECH30790.A2020','TECH30723.A2020','TECH30607.A2020','FINA50200.A2020','COMP30904.A2020','MATH30603.A2020','ENTR31036.A2020','LANG91504.A2020')
);

-- insert new text elem
INSERT INTO TENJIN_SYLLABUSELEMENT (SYLLABUSELEMENT_ID, CLASS_TYPE, TEMPLATESTRUCTURE_ID, COMMON, EQUALS_PUBLISHED, PROVIDER_ID, DESCRIPTION, CREATED_DATE, CREATED_BY, LAST_MODIFIED_DATE, LAST_MODIFIED_BY, SITE_ID, PARENT_ID) 
(SELECT syllabuselement_id_seq.nextval, 'ca.hec.tenjin.api.model.syllabus.SyllabusTextElement', -1, 1, 0, 2, 'Text Temporaire', SYSDATE, 'cvo_admin_insert_plagiat', SYSDATE, 'cvo_admin_insert_plagiat', ts.SITE_ID, ts.SYLLABUSELEMENT_ID 
FROM TENJIN_SYLLABUSELEMENT ts
WHERE ts.CREATED_BY = 'cvo_admin_insert_plagiat' AND ts.TEMPLATESTRUCTURE_ID = 693
AND ts.SITE_ID IN ('RHRT30303.A2020','TECH30714.A2020','RHRT30323.A2020','RHRT30320.A2020','FINA30221.A2020','DDRS30515.A2020','ENTR31036.A2020','ENTR31027.A2020','TECH30715.A2020','TECH30718.A2020','ENTR31031.A2020','TECH30719.A2020','MARK30118.A2020','TECH30790.A2020','TECH30723.A2020','TECH30607.A2020','FINA50200.A2020','COMP30904.A2020','MATH30603.A2020','ENTR31036.A2020','LANG91504.A2020')
);

-- insert new mappings 
INSERT INTO TENJIN_SYLLABUSELEMENTMAPPING (SYLLABUSELEMENTMAPPING_ID, SYLLABUS_ID, SYLLABUSELEMENT_ID, DISPLAY_ORDER, HIDDEN, EQUALS_PUBLISHED)
(SELECT SYLLABUSELMAP_ID_SEQ.nextval, tsyl.SYLLABUS_ID, ts.SYLLABUSELEMENT_ID, 0, 0, 0
FROM TENJIN_SYLLABUSELEMENT ts, TENJIN_SYLLABUS tsyl
WHERE ts.SITE_ID = tsyl.SITE_ID AND tsyl.DELETED = 0
AND ts.CREATED_BY = 'cvo_admin_insert_plagiat'
AND ts.TEMPLATESTRUCTURE_ID IN (-1, 693)
AND ts.SITE_ID IN ('RHRT30303.A2020','TECH30714.A2020','RHRT30323.A2020','RHRT30320.A2020','FINA30221.A2020','DDRS30515.A2020','ENTR31036.A2020','ENTR31027.A2020','TECH30715.A2020','TECH30718.A2020','ENTR31031.A2020','TECH30719.A2020','MARK30118.A2020','TECH30790.A2020','TECH30723.A2020','TECH30607.A2020','FINA50200.A2020','COMP30904.A2020','MATH30603.A2020','ENTR31036.A2020','LANG91504.A2020')
);