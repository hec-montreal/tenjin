// loader les donnees du plan de cours
opensyllabusApp.controller('OpensyllabusCtrl', ['$rootScope', '$scope', '$interval', '$timeout', '$q', 'SyllabusService', 'TreeService', 'ResourcesService', 'CitationsService', 'SakaiToolsService', 'config', '$translate', 'AlertService', 'tmhDynamicLocale', 'Modernizr', 'variables', function($rootScope, $scope, $interval, $timeout, $q, SyllabusService, TreeService, ResourcesService, CitationsService, SakaiToolsService, config, $translate, AlertService, tmhDynamicLocale, Modernizr, variables) {
	'use strict';

    $scope.infos = {};
 
    $scope.alertService = AlertService;
    $scope.syllabusService = SyllabusService;

    $scope.resourcesService = ResourcesService;

    $scope.planLoaded = false;
    $scope.templateLoaded = false;

    $scope.variables = variables;

    // test taille de l'écran
    var query = Modernizr.mq('(max-width: 767px)');
    if (query) {
        // smartphone
        variables.device = "mobile";
        variables.mode = "lecture";
        $scope.syllabusService.showMobileMenu = true;
    } else {
        $scope.syllabusService.showMobileMenu = false;
    }

    var localePromise = tmhDynamicLocale.set('fr');
    localePromise.then( function($ok) {
        $translate.use('fr');
    }, function($error) {

    }); 

    $scope.$watch('syllabusService.syllabus', function(newValue, oldValue) {

        var syllabusSaved = SyllabusService.getSyllabusSaved();
        if (syllabusSaved) {
            if (angular.equals(newValue, syllabusSaved)) {    
                SyllabusService.setDirty(false);
            }else {
                SyllabusService.setDirty(true);
            }
        }

    }, true);

    // test extension propriétés
    // var syllabusVide = {"siteId":"2-200-96.A2015.A01","courseTitle":null,"templateId":1,"locale":"fr_CA","createdBy":"admin","createdDate":1446482994000,"lastModifiedBy":"admin","lastModifiedDate":1446482996000,"elements":[{"parentId":null,"templateElementId":1,"title":"Présentation du cours","description":"description","type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"parentId":1,"templateElementId":3,"title":"Objectif","description":null,"type":"rubric","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446666195000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"text","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446492511000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"text":"<ul><li>Course overview </li><li>Why have an MBA course on IT? </li><li>IT as a lever for organizational transformation </li><li>Business process and business model transformation : The case of Amazon.com</li><li>Principal challenges of IT management </li><li>The role of managers </li><li>Definition and classification of technologies </li><li>IT trends</li></ul>"}},{"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"citation","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}},{"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"contact_info","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"contactAvailability":"all the time","contactLastName":"Talbot","contactEmail":"jean.talbot@hec.ca","contactTitle":"Professor","contactFirstName":"Jean","contactTelephone":"514-340-6494","contactOfficeRoom":"4.624"}},{"parentId":4,"templateElementId":2,"title":"Video Melies","description":null,"type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0\" width=\"480\" height=\"300\" id=\"lecteur-melies\" align=\"middle\"><param name=\"movie\" value=\"http://tintin.hec.ca/audiovisuel/melies/melies2/lecteur-melies.swf\" /><param name=FlashVars value=\"nomFichier=17411_Alain_Brigitte.mp4&skinPath=http://tintin.hec.ca/audiovisuel/melies/melies2/&debut=0&fin=0\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"true\" /><param name=\"quality\" value=\"high\" /><embed src=\"http://tintin.hec.ca/audiovisuel/melies/melies2/lecteur-melies.swf\" FlashVars=\"nomFichier=17411_Alain_Brigitte.mp4&skinPath=http://tintin.hec.ca/audiovisuel/melies/melies2/&debut=0&fin=0\" quality=\"high\" allowFullScreen=\"true\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" type=\"application/x-shockwave-flash\" width=\"480\" height=\"300\" allowscriptaccess=\"always\"></embed></object>"}},{"parentId":4,"templateElementId":2,"title":"Video DailyMotion","description":null,"type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"http://www.dailymotion.com/video/x38xi1r_chairman-hec-punjab-prof-dr-muhammad-nizamuddin-with-ahmed-pervaiz-city42_news"}},{"parentId":4,"templateElementId":2,"title":"Video Vimeo","description":"vimeo video","type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"https://vimeo.com/channels/staffpicks/142293358"}},{"parentId":4,"templateElementId":2,"title":"Video YouTube","description":"youtube video","type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"https://www.youtube.com/watch?v=5KzSyGfFLz4"}}]},{"parentId":1,"templateElementId":3,"title":"Approche Pédagogique","description":null,"type":"rubric","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446666195000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"document","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}},{"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"hyperlink","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"hyperlinkUrl":"http://www.hec.ca","hyperlinkType":"Article"}},{"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"image","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"imageUrl":"http://pixel.brit.co/wp-content/uploads/2013/09/6-Staypuft.jpg"}},{"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"sakai_tool","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}}]}]},{"parentId":null,"templateElementId":1,"title":"Coordonnées","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"parentId":null,"templateElementId":1,"title":"Matériel pédagogique","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"parentId":null,"templateElementId":1,"title":"Évaluations","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"parentId":null,"templateElementId":1,"title":"Organisation du cours","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]}]};
    // var syllabus = {"id":1,"siteId":"2-200-96.A2015.A01","courseTitle":null,"templateId":1,"locale":"fr_CA","createdBy":"admin","createdDate":1446482994000,"lastModifiedBy":"admin","lastModifiedDate":1446482996000,"elements":[{"id":1,"parentId":null,"templateElementId":1,"title":"Présentation du cours","description":"description","type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"id":4,"parentId":1,"templateElementId":3,"title":"Objectif","description":null,"type":"rubric","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446666195000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"id":2,"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"text","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446492511000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"text":"<ul><li>Course overview </li><li>Why have an MBA course on IT? </li><li>IT as a lever for organizational transformation </li><li>Business process and business model transformation : The case of Amazon.com</li><li>Principal challenges of IT management </li><li>The role of managers </li><li>Definition and classification of technologies </li><li>IT trends</li></ul>"}},{"id":3,"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"citation","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}},{"id":5,"parentId":4,"templateElementId":2,"title":null,"description":null,"type":"contact_info","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"contactAvailability":"all the time","contactLastName":"Talbot","contactEmail":"jean.talbot@hec.ca","contactTitle":"Professor","contactFirstName":"Jean","contactTelephone":"514-340-6494","contactOfficeRoom":"4.624"}},{"id":15,"parentId":4,"templateElementId":2,"title":"Video Melies","description":null,"type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0\" width=\"480\" height=\"300\" id=\"lecteur-melies\" align=\"middle\"><param name=\"movie\" value=\"http://tintin.hec.ca/audiovisuel/melies/melies2/lecteur-melies.swf\" /><param name=FlashVars value=\"nomFichier=17411_Alain_Brigitte.mp4&skinPath=http://tintin.hec.ca/audiovisuel/melies/melies2/&debut=0&fin=0\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"true\" /><param name=\"quality\" value=\"high\" /><embed src=\"http://tintin.hec.ca/audiovisuel/melies/melies2/lecteur-melies.swf\" FlashVars=\"nomFichier=17411_Alain_Brigitte.mp4&skinPath=http://tintin.hec.ca/audiovisuel/melies/melies2/&debut=0&fin=0\" quality=\"high\" allowFullScreen=\"true\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" type=\"application/x-shockwave-flash\" width=\"480\" height=\"300\" allowscriptaccess=\"always\"></embed></object>"}},{"id":16,"parentId":4,"templateElementId":2,"title":"Video DailyMotion","description":null,"type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"http://www.dailymotion.com/video/x38xi1r_chairman-hec-punjab-prof-dr-muhammad-nizamuddin-with-ahmed-pervaiz-city42_news"}},{"id":17,"parentId":4,"templateElementId":2,"title":"Video Vimeo","description":"vimeo video","type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"https://vimeo.com/channels/staffpicks/142293358"}},{"id":18,"parentId":4,"templateElementId":2,"title":"Video YouTube","description":"youtube video","type":"video","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"videoUrl":"https://www.youtube.com/watch?v=5KzSyGfFLz4"}}]},{"id":6,"parentId":1,"templateElementId":3,"title":"Approche Pédagogique","description":null,"type":"rubric","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446666195000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[{"id":7,"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"document","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}},{"id":8,"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"hyperlink","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"hyperlinkUrl":"http://www.hec.ca","hyperlinkType":"Article"}},{"id":9,"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"image","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{"imageUrl":"http://pixel.brit.co/wp-content/uploads/2013/09/6-Staypuft.jpg"}},{"id":10,"parentId":6,"templateElementId":2,"title":null,"description":null,"type":"sakai_tool","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446663650000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{}}]}]},{"id":11,"parentId":null,"templateElementId":1,"title":"Coordonnées","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"id":12,"parentId":null,"templateElementId":1,"title":"Matériel pédagogique","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"id":13,"parentId":null,"templateElementId":1,"title":"Évaluations","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]},{"id":14,"parentId":null,"templateElementId":1,"title":"Organisation du cours","description":null,"type":"composite","publicElement":true,"shareable":true,"important":true,"availabilityStartDate":1446483407000,"availabilityEndDate":null,"createdDate":null,"createdBy":null,"lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[]}]};
    // angular.extend(syllabusVide, syllabus);

    // mockup
    if (config.mockUp) {
        // MODE DECONNECTE
        // mockup syllabus
        var syllabus = {"id":1,"siteId":"52-701-02A.A2013.P3","courseTitle":"Information Technologies","templateId":1,"locale":"en_US","createdBy":"admin","createdDate":1447084701586,"lastModifiedBy":"admin","lastModifiedDate":1447084708485,"elements":[{"id":1,"parentId":null,"templateStructureId":1,"syllabusId":1,"title":"Présentation du cours - test","description":"description","publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103144000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"elements":[{"id":1305,"parentId":1,"templateStructureId":2,"syllabusId":1,"title":"Description","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":0,"availabilityStartDate":1450289851842,"availabilityEndDate":null,"createdDate":1450289851898,"createdBy":"Curtis Van Osch","lastModifiedDate":1450289851898,"lastModifiedBy":"Curtis Van Osch","sections":[],"attributes":{},"elements":[{"id":1277,"parentId":1305,"templateStructureId":292,"syllabusId":1,"title":"testimage","description":"Je suis dans le désert <br> Et il fait chaud","publicElement":null,"shareable":null,"important":false,"displayOrder":0,"availabilityStartDate":1450300792142,"availabilityEndDate":null,"createdDate":1450300799780,"createdBy":"Johan Julien","lastModifiedDate":1450300799780,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{"resourceId":"/group/52-701-02A.A2013.P3/Desert.jpg"},"type":"image"},{"id":1309,"parentId":1305,"templateStructureId":293,"syllabusId":1,"title":null,"description":"<p>mavideo</p>\n","publicElement":null,"shareable":null,"important":null,"displayOrder":1,"availabilityStartDate":1450370638630,"availabilityEndDate":null,"createdDate":1450370829158,"createdBy":"Johan Julien","lastModifiedDate":1450370829158,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{"videoUrl":"https://www.youtube.com/watch?v=aWk4wCGPgaQ"},"type":"video"},{"id":1312,"parentId":1305,"templateStructureId":37,"syllabusId":1,"title":"coucou","description":"<p>coucou</p>\n","publicElement":null,"shareable":null,"important":null,"displayOrder":2,"availabilityStartDate":1450464268238,"availabilityEndDate":null,"createdDate":1450464273131,"createdBy":"Johan Julien","lastModifiedDate":1450464273131,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"type":"text"}],"type":"rubric"},{"id":2,"parentId":1,"templateStructureId":3,"syllabusId":1,"title":"Objectif","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450464260570,"lastModifiedBy":"Johan Julien","sections":["C3","D4"],"attributes":{},"elements":[{"id":3,"parentId":2,"templateStructureId":40,"syllabusId":1,"title":"Je suis un texte","description":"<p>Il était une fois...</p>\n<p style=\"color:green\">Ils vécurent heureux et euront beaucoup d'enfants.</p>","publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"text":"<ul><li>Course overview </li><li>Why have an MBA course on IT? </li><li>IT as a lever for organizational transformation </li><li>Business process and business model transformation : The case of Amazon.com</li><li>Principal challenges of IT management </li><li>The role of managers </li><li>Definition and classification of technologies </li><li>IT trends</li></ul>"},"type":"text"}],"type":"rubric"}],"type":"composite"},{"id":11,"parentId":null,"templateStructureId":5,"syllabusId":1,"title":"Coordonnées","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103146000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"elements":[{"id":1024,"parentId":11,"templateStructureId":6,"syllabusId":1,"title":"Coordonnateur","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":0,"availabilityStartDate":1449758665436,"availabilityEndDate":null,"createdDate":null,"createdBy":"admin","lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[],"type":"rubric"},{"id":36,"parentId":11,"templateStructureId":46,"syllabusId":1,"title":"Enseignant(s)","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{},"elements":[{"id":5,"parentId":36,"templateStructureId":51,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"contactAvailability":"all the time","contactLastName":"Talbot","contactEmail":"jean.talbot@hec.ca","contactTitle":"Professor","contactFirstName":"Jean","contactTelephone":"514-340-6494","contactOfficeRoom":"4.624"},"type":"contact_info"}],"type":"rubric"},{"id":1025,"parentId":11,"templateStructureId":47,"syllabusId":1,"title":"Stagiaire(s) d'enseignement","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":2,"availabilityStartDate":1449758670791,"availabilityEndDate":null,"createdDate":null,"createdBy":"admin","lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[],"type":"rubric"},{"id":1030,"parentId":11,"templateStructureId":49,"syllabusId":1,"title":"Secrétaire(s)","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":3,"availabilityStartDate":1449759700677,"availabilityEndDate":null,"createdDate":null,"createdBy":"admin","lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[],"type":"rubric"},{"id":1181,"parentId":11,"templateStructureId":48,"syllabusId":1,"title":"Conférencier(s)","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":4,"availabilityStartDate":1450191802820,"availabilityEndDate":null,"createdDate":1450191802838,"createdBy":"Johan Julien","lastModifiedDate":1450288405911,"lastModifiedBy":"Curtis Van Osch","sections":[],"attributes":{},"elements":[],"type":"rubric"}],"type":"composite"},{"id":12,"parentId":null,"templateStructureId":7,"syllabusId":1,"title":"Matériel pédagogique","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":2,"availabilityStartDate":1447103146000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"elements":[{"id":37,"parentId":12,"templateStructureId":55,"syllabusId":1,"title":"Ressource bibliographiques","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{},"elements":[{"id":4,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"journal":"Journal of Java Programming","author":"Parsons, David","title":"Foundational Java : key elements and practical programming ","issn":"123456789","pages":"355","issue":"2","volume":"1","year":"2012","type":"article","section":"3"},"type":"citation"},{"id":25,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{"author":"Frankel, Gabriella","title":"How the DevOps revolution informs software architecture","pages":"24-32","isbn":"123456789","year":"2015","type":"report","url":"https://www.oreilly.com/ideas/how-the-devops-revolution-informs-software-architecture","publication":"O'Reilly Media","institution":"Institution"},"type":"citation"},{"id":26,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":2,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{"proceedTitle":"Communication présentée au 83e congrès de l'ACFAS, Rimouski, Québec. Résumé repéré à http://www.acfas.ca/evenements/congres/","author":"Morin, M.-H.,Clément, M. et Levesque, A","title":" Sortir du cadre : pour une vision inclusive des acteurs et services de la première ligne en santé mentale.","year":"2015","type":"proceed"},"type":"citation"},{"id":27,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":3,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{"author":"Van Osch, Curtis","title":"Inventing a Better Mousetrap","year":"2015","type":"webPage","date":"2015-09-027","url":"http://www.oreilly.com/","siteTitle":"O'Reilly Media"},"type":"citation"},{"id":28,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":4,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{"edition":"2012","author":"Parsons, David","title":"Foundational Java : key elements and practical programming ","editor":"Springer","pages":"355","year":"2012","type":"book","publication":"London; New-York"},"type":"citation"},{"id":29,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":5,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{"sectionTitle":"Animating Interview Narratives","author":"Holstein, James A. and Jaber F. Gubrium","title":"ualitative Research: Issues of Theory, ","editor":"David Silverman","pages":"98-155","volume":"9","year":"2011","town":"London","type":"bookSection"},"type":"citation"},{"id":7,"parentId":37,"templateStructureId":57,"syllabusId":1,"title":"Un document","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":6,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"documentUrl":"/group/52-701-02A.A2013.P3/Book1.xlsx"},"type":"document"},{"id":1183,"parentId":37,"templateStructureId":59,"syllabusId":1,"title":null,"description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":7,"availabilityStartDate":null,"availabilityEndDate":null,"createdDate":1450202621424,"createdBy":"Nadine Blanchette","lastModifiedDate":1450202621424,"lastModifiedBy":"Nadine Blanchette","sections":[],"attributes":{},"type":"citation"}],"type":"rubric"},{"id":1029,"parentId":12,"templateStructureId":8,"syllabusId":1,"title":"Ressources bibliographiques complémentaire","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":1,"availabilityStartDate":1449758995480,"availabilityEndDate":null,"createdDate":null,"createdBy":"admin","lastModifiedDate":null,"lastModifiedBy":null,"sections":[],"attributes":{},"elements":[],"type":"rubric"}],"type":"composite"},{"id":13,"parentId":null,"templateStructureId":12,"syllabusId":1,"title":"Évaluations","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":3,"availabilityStartDate":1447103146000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"elements":[{"id":30,"parentId":13,"templateStructureId":80,"syllabusId":1,"title":"Examen Final","description":"L'examen final","publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450466276636,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{"evalMode":"individual","evalInClass":"true","evalWeight":"70","evalType":"exam","evalOral":"false","evalDate":"2015-11-16","evalElectronic":"true","evalWritten":"true","evalPaper":"false","evalAtHome":"false","evaSubmissionType":"electronic"},"elements":[{"id":1182,"parentId":30,"templateStructureId":91,"syllabusId":1,"title":"Description","description":null,"publicElement":null,"shareable":null,"important":false,"displayOrder":0,"availabilityStartDate":1450201302175,"availabilityEndDate":null,"createdDate":1450201330284,"createdBy":"Johan Julien","lastModifiedDate":1450201330284,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[],"type":"rubric"},{"id":31,"parentId":30,"templateStructureId":85,"syllabusId":1,"title":"Description","description":"La rubrique","publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103145000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450288405918,"lastModifiedBy":"Curtis Van Osch","sections":[],"attributes":{},"elements":[{"id":32,"parentId":31,"templateStructureId":117,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447253848698,"availabilityEndDate":null,"createdDate":1447253854748,"createdBy":"admin","lastModifiedDate":1447253862374,"lastModifiedBy":"admin","sections":[],"attributes":{"text":"Voici le text pour l'examen final"},"type":"text"}],"type":"rubric"}],"type":"evaluation"},{"id":19,"parentId":13,"templateStructureId":13,"syllabusId":1,"title":"Examen Intra","description":"L'examen intra","publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450466276657,"lastModifiedBy":"Johan Julien","sections":["C3","D4"],"attributes":{"evalSubmissionType":"electronic","evalMode":"team","evalInClass":"true","evalWeight":"30","evalType":"exam","evalOral":"true","evalDate":"2015-11-16","evalElectronic":"true","evalWritten":"true","evalPaper":"true","evalAtHome":"true"},"elements":[{"id":38,"parentId":19,"templateStructureId":85,"syllabusId":1,"title":"Description","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{},"elements":[{"id":20,"parentId":38,"templateStructureId":117,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"text":"Voici le text pour l'examen intra"},"type":"text"},{"id":10,"parentId":38,"templateStructureId":121,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103146000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"type":"sakai_tool"}],"type":"rubric"}],"type":"evaluation"}],"type":"composite"},{"id":14,"parentId":null,"templateStructureId":14,"syllabusId":1,"title":"Organisation du cours","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":4,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{},"elements":[{"id":1313,"parentId":14,"templateStructureId":17,"syllabusId":1,"title":"Regroupement 1","description":null,"publicElement":null,"shareable":null,"important":null,"displayOrder":0,"availabilityStartDate":null,"availabilityEndDate":null,"createdDate":1450464310218,"createdBy":"Johan Julien","lastModifiedDate":1450464345006,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[{"id":1319,"parentId":1313,"templateStructureId":34,"syllabusId":1,"title":"Ceci est mon tp","description":null,"publicElement":null,"shareable":null,"important":null,"displayOrder":0,"availabilityStartDate":null,"availabilityEndDate":null,"createdDate":1450464493943,"createdBy":"Johan Julien","lastModifiedDate":1450465905282,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[],"type":"tutorial"},{"id":22,"parentId":1313,"templateStructureId":16,"syllabusId":1,"title":"Séance de TP 1","description":"Une séance de TP","publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450465905289,"lastModifiedBy":"Johan Julien","sections":["C3","D4"],"attributes":{},"elements":[],"type":"tutorial"},{"id":1314,"parentId":1313,"templateStructureId":33,"syllabusId":1,"title":"Ma scéance","description":null,"publicElement":null,"shareable":null,"important":null,"displayOrder":2,"availabilityStartDate":null,"availabilityEndDate":null,"createdDate":1450464380526,"createdBy":"Johan Julien","lastModifiedDate":1450464580516,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[],"type":"lecture"}],"type":"composite"},{"id":33,"parentId":14,"templateStructureId":17,"syllabusId":1,"title":"Regroupement: Semaine 2","description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103147000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450464345020,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[{"id":34,"parentId":33,"templateStructureId":33,"syllabusId":1,"title":"Séance de cours 2","description":"Une séance de cours","publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":[],"attributes":{},"elements":[{"id":24,"parentId":34,"templateStructureId":294,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"text":"Voici le text pour la première séance de travaux pratique"},"type":"text"}],"type":"lecture"},{"id":21,"parentId":33,"templateStructureId":15,"syllabusId":1,"title":"Séance de cours 1","description":"Une séance de cours","publicElement":true,"shareable":true,"important":false,"displayOrder":1,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450464345032,"lastModifiedBy":"Johan Julien","sections":["C3","D4"],"attributes":{},"elements":[],"type":"lecture"},{"id":35,"parentId":33,"templateStructureId":34,"syllabusId":1,"title":"Séance de TP 2","description":"Une séance de TP","publicElement":true,"shareable":true,"important":false,"displayOrder":2,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1450464397983,"lastModifiedBy":"Johan Julien","sections":[],"attributes":{},"elements":[{"id":23,"parentId":35,"templateStructureId":299,"syllabusId":1,"title":null,"description":null,"publicElement":true,"shareable":true,"important":false,"displayOrder":0,"availabilityStartDate":1447103148000,"availabilityEndDate":null,"createdDate":1447163694000,"createdBy":"admin","lastModifiedDate":1447163796000,"lastModifiedBy":"admin","sections":["C3","D4"],"attributes":{"text":"Voici le text pour la première séance de cours "},"type":"text"}],"type":"tutorial"}],"type":"composite"}],"type":"composite"}]};
        SyllabusService.setSyllabus(syllabus);
        // Masquer les items du menu sur mobile
        SyllabusService.hideItemsInit();

        // mockup template
        var template = {"114":[{"id":287,"label":"Texte","type":"text"},{"id":288,"label":"Document","type":"document"},{"id":289,"label":"Hyperlien","type":"url"},{"id":290,"label":"Coordonnées","type":"composite"},{"id":291,"label":"Lien vers un outil","type":"sakai_entity"}],"115":[{"id":262,"label":"Texte","type":"text"},{"id":263,"label":"Document","type":"document"},{"id":264,"label":"Hyperlien","type":"url"},{"id":265,"label":"Coordonnées","type":"composite"},{"id":266,"label":"Lien vers un outil","type":"sakai_entity"}],"112":[{"id":277,"label":"Texte","type":"text"},{"id":278,"label":"Document","type":"document"},{"id":279,"label":"Hyperlien","type":"url"},{"id":280,"label":"Coordonnées","type":"composite"},{"id":281,"label":"Lien vers un outil","type":"sakai_entity"}],"113":[{"id":282,"label":"Texte","type":"text"},{"id":283,"label":"Document","type":"document"},{"id":284,"label":"Hyperlien","type":"url"},{"id":285,"label":"Coordonnées","type":"composite"},{"id":286,"label":"Lien vers un outil","type":"sakai_entity"}],"110":[{"id":267,"label":"Texte","type":"text"},{"id":268,"label":"Document","type":"document"},{"id":269,"label":"Hyperlien","type":"url"},{"id":270,"label":"Coordonnées","type":"composite"},{"id":271,"label":"Lien vers un outil","type":"sakai_entity"}],"111":[{"id":272,"label":"Texte","type":"text"},{"id":273,"label":"Document","type":"document"},{"id":274,"label":"Hyperlien","type":"url"},{"id":275,"label":"Coordonnées","type":"composite"},{"id":276,"label":"Lien vers un outil","type":"sakai_entity"}],"35":[{"id":76,"label":"Texte","type":"text"},{"id":77,"label":"Document","type":"document"},{"id":78,"label":"Hyperlien","type":"url"},{"id":79,"label":"Référence bibliographique","type":"citation"}],"33":[{"id":294,"label":"Texte","type":"text"},{"id":295,"label":"Document","type":"document"},{"id":296,"label":"Hyperlien","type":"url"},{"id":297,"label":"Référence bibliographique","type":"citation"},{"id":298,"label":"Lien vers un outil","type":"sakai_entity"}],"34":[{"id":299,"label":"Texte","type":"text"},{"id":300,"label":"Document","type":"document"},{"id":301,"label":"Hyperlien","type":"url"},{"id":302,"label":"Référence bibliographique","type":"citation"},{"id":303,"label":"Lien vers un outil","type":"sakai_entity"}],"82":[{"id":103,"label":"Description","type":"rubric"},{"id":98,"label":"Objectifs","type":"rubric"},{"id":99,"label":"Critère d'évaluation","type":"rubric"},{"id":100,"label":"Préparation à l'évaluation","type":"rubric"},{"id":101,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":102,"label":"Ressources générales","type":"rubric"}],"83":[{"id":109,"label":"Description","type":"rubric"},{"id":104,"label":"Objectifs","type":"rubric"},{"id":105,"label":"Critère d'évaluation","type":"rubric"},{"id":106,"label":"Préparation à l'évaluation","type":"rubric"},{"id":107,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":108,"label":"Ressources générales","type":"rubric"}],"80":[{"id":91,"label":"Description","type":"rubric"},{"id":86,"label":"Objectifs","type":"rubric"},{"id":87,"label":"Critère d'évaluation","type":"rubric"},{"id":88,"label":"Préparation à l'évaluation","type":"rubric"},{"id":89,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":90,"label":"Ressources générales","type":"rubric"}],"81":[{"id":97,"label":"Description","type":"rubric"},{"id":92,"label":"Objectifs","type":"rubric"},{"id":93,"label":"Critère d'évaluation","type":"rubric"},{"id":94,"label":"Préparation à l'évaluation","type":"rubric"},{"id":95,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":96,"label":"Ressources générales","type":"rubric"}],"86":[{"id":147,"label":"Texte","type":"text"},{"id":148,"label":"Document","type":"document"},{"id":149,"label":"Hyperlien","type":"url"},{"id":150,"label":"Coordonnées","type":"composite"},{"id":151,"label":"Lien vers un outil","type":"sakai_entity"}],"87":[{"id":156,"label":"Lien vers un outil","type":"sakai_entity"},{"id":155,"label":"Coordonnées","type":"composite"},{"id":154,"label":"Hyperlien","type":"url"},{"id":153,"label":"Document","type":"document"},{"id":152,"label":"Texte","type":"text"}],"84":[{"id":115,"label":"Description","type":"rubric"},{"id":110,"label":"Objectifs","type":"rubric"},{"id":111,"label":"Critère d'évaluation","type":"rubric"},{"id":112,"label":"Préparation à l'évaluation","type":"rubric"},{"id":113,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":114,"label":"Ressources générales","type":"rubric"}],"85":[{"id":117,"label":"Texte","type":"text"},{"id":118,"label":"Document","type":"document"},{"id":121,"label":"Lien vers un outil","type":"sakai_entity"},{"id":120,"label":"Coordonnées","type":"composite"},{"id":119,"label":"Hyperlien","type":"url"}],"3":[{"id":40,"label":"Texte","type":"text"},{"id":41,"label":"Document","type":"document"},{"id":42,"label":"Hyperlien","type":"url"},{"id":304,"label":"Image","type":"image"},{"id":305,"label":"Vidéo","type":"video"}],"2":[{"id":37,"label":"Texte","type":"text"},{"id":38,"label":"Document","type":"document"},{"id":39,"label":"Hyperlien","type":"url"},{"id":292,"label":"Image","type":"image"},{"id":293,"label":"Vidéo","type":"video"}],"1":[{"id":2,"label":"Description","type":"rubric"},{"id":3,"label":"Objectifs","type":"rubric"},{"id":4,"label":"Approche pédagogique","type":"rubric"}],"7":[{"id":55,"label":"Ressources bibliographiques","type":"rubric"},{"id":8,"label":"Ressources bibliographiques complémentaire","type":"rubric"},{"id":9,"label":"Ressources générales","type":"rubric"},{"id":10,"label":"Cas","type":"rubric"},{"id":11,"label":"Outils","type":"rubric"},{"id":35,"label":"Anciens examens","type":"rubric"}],"6":[{"id":50,"label":"Coordonnée","type":"contact_info"}],"5":[{"id":6,"label":"Coordonnateur","type":"rubric"},{"id":46,"label":"Enseignant(s)","type":"rubric"},{"id":47,"label":"Stagiaire(s) d'enseignement","type":"rubric"},{"id":48,"label":"Conférencier(s)","type":"rubric"},{"id":49,"label":"Secrétaire(s)","type":"rubric"}],"4":[{"id":43,"label":"Texte","type":"text"},{"id":44,"label":"Document","type":"document"},{"id":45,"label":"Hyperlien","type":"url"},{"id":306,"label":"Image","type":"image"},{"id":307,"label":"Vidéo","type":"video"}],"9":[{"id":64,"label":"Texte","type":"text"},{"id":65,"label":"Document","type":"document"},{"id":66,"label":"Hyperlien","type":"url"},{"id":67,"label":"Référence bibliographique","type":"citation"}],"8":[{"id":60,"label":"Texte","type":"text"},{"id":61,"label":"Document","type":"document"},{"id":62,"label":"Hyperlien","type":"url"},{"id":63,"label":"Référence bibliographique","type":"citation"}],"19":[{"id":127,"label":"Texte","type":"text"},{"id":128,"label":"Document","type":"document"},{"id":131,"label":"Lien vers un outil","type":"sakai_entity"},{"id":130,"label":"Coordonnées","type":"composite"},{"id":129,"label":"Hyperlien","type":"url"}],"55":[{"id":56,"label":"Texte","type":"text"},{"id":57,"label":"Document","type":"document"},{"id":58,"label":"Hyperlien","type":"url"},{"id":59,"label":"Référence bibliographique","type":"citation"}],"17":[{"id":33,"label":"Séance de cours","type":"lecture"},{"id":34,"label":"Séance de travaux pratique","type":"tutorial"}],"18":[{"id":122,"label":"Texte","type":"text"},{"id":123,"label":"Document","type":"document"},{"id":126,"label":"Lien vers un outil","type":"sakai_entity"},{"id":125,"label":"Coordonnées","type":"composite"},{"id":124,"label":"Hyperlien","type":"url"}],"15":[{"id":23,"label":"Texte","type":"text"},{"id":24,"label":"Document","type":"document"},{"id":25,"label":"Hyperlien","type":"url"},{"id":26,"label":"Référence bibliographique","type":"citation"},{"id":27,"label":"Lien vers un outil","type":"sakai_entity"}],"16":[{"id":28,"label":"Texte","type":"text"},{"id":29,"label":"Document","type":"document"},{"id":30,"label":"Hyperlien","type":"url"},{"id":31,"label":"Référence bibliographique","type":"citation"},{"id":32,"label":"Lien vers un outil","type":"sakai_entity"}],"13":[{"id":85,"label":"Description","type":"rubric"},{"id":18,"label":"Objectifs","type":"rubric"},{"id":19,"label":"Critère d'évaluation","type":"rubric"},{"id":20,"label":"Préparation à l'évaluation","type":"rubric"},{"id":21,"label":"Modalités de remise et pénalités","type":"rubric"},{"id":22,"label":"Ressources générales","type":"rubric"}],"14":[{"id":17,"label":"Regroupement","type":"composite"},{"id":15,"label":"Séance de cours","type":"lecture"},{"id":16,"label":"Séance de travaux pratique","type":"tutorial"}],"11":[{"id":72,"label":"Texte","type":"text"},{"id":73,"label":"Document","type":"document"},{"id":74,"label":"Hyperlien","type":"url"},{"id":75,"label":"Référence bibliographique","type":"citation"}],"12":[{"id":13,"label":"Examen intra","type":"examen"},{"id":80,"label":"Examen final","type":"examen"},{"id":81,"label":"Travail","type":"evaluation"},{"id":82,"label":"Participation","type":"evaluation"},{"id":83,"label":"Test/Quiz","type":"evaluation"},{"id":84,"label":"Autre","type":"evaluation"}],"21":[{"id":137,"label":"Texte","type":"text"},{"id":138,"label":"Document","type":"document"},{"id":141,"label":"Lien vers un outil","type":"sakai_entity"},{"id":140,"label":"Coordonnées","type":"composite"},{"id":139,"label":"Hyperlien","type":"url"}],"20":[{"id":132,"label":"Texte","type":"text"},{"id":133,"label":"Document","type":"document"},{"id":136,"label":"Lien vers un outil","type":"sakai_entity"},{"id":135,"label":"Coordonnées","type":"composite"},{"id":134,"label":"Hyperlien","type":"url"}],"109":[{"id":232,"label":"Texte","type":"text"},{"id":233,"label":"Document","type":"document"},{"id":234,"label":"Hyperlien","type":"url"},{"id":235,"label":"Coordonnées","type":"composite"},{"id":236,"label":"Lien vers un outil","type":"sakai_entity"}],"108":[{"id":257,"label":"Texte","type":"text"},{"id":258,"label":"Document","type":"document"},{"id":259,"label":"Hyperlien","type":"url"},{"id":260,"label":"Coordonnées","type":"composite"},{"id":261,"label":"Lien vers un outil","type":"sakai_entity"}],"107":[{"id":252,"label":"Texte","type":"text"},{"id":253,"label":"Document","type":"document"},{"id":254,"label":"Hyperlien","type":"url"},{"id":255,"label":"Coordonnées","type":"composite"},{"id":256,"label":"Lien vers un outil","type":"sakai_entity"}],"106":[{"id":247,"label":"Texte","type":"text"},{"id":248,"label":"Document","type":"document"},{"id":249,"label":"Hyperlien","type":"url"},{"id":250,"label":"Coordonnées","type":"composite"},{"id":251,"label":"Lien vers un outil","type":"sakai_entity"}],"105":[{"id":242,"label":"Texte","type":"text"},{"id":243,"label":"Document","type":"document"},{"id":244,"label":"Hyperlien","type":"url"},{"id":245,"label":"Coordonnées","type":"composite"},{"id":246,"label":"Lien vers un outil","type":"sakai_entity"}],"104":[{"id":237,"label":"Texte","type":"text"},{"id":238,"label":"Document","type":"document"},{"id":239,"label":"Hyperlien","type":"url"},{"id":240,"label":"Coordonnées","type":"composite"},{"id":241,"label":"Lien vers un outil","type":"sakai_entity"}],"103":[{"id":202,"label":"Texte","type":"text"},{"id":203,"label":"Document","type":"document"},{"id":204,"label":"Hyperlien","type":"url"},{"id":205,"label":"Coordonnées","type":"composite"},{"id":206,"label":"Lien vers un outil","type":"sakai_entity"}],"99":[{"id":212,"label":"Texte","type":"text"},{"id":213,"label":"Document","type":"document"},{"id":214,"label":"Hyperlien","type":"url"},{"id":215,"label":"Coordonnées","type":"composite"},{"id":216,"label":"Lien vers un outil","type":"sakai_entity"}],"102":[{"id":227,"label":"Texte","type":"text"},{"id":228,"label":"Document","type":"document"},{"id":229,"label":"Hyperlien","type":"url"},{"id":230,"label":"Coordonnées","type":"composite"},{"id":231,"label":"Lien vers un outil","type":"sakai_entity"}],"101":[{"id":222,"label":"Texte","type":"text"},{"id":223,"label":"Document","type":"document"},{"id":224,"label":"Hyperlien","type":"url"},{"id":225,"label":"Coordonnées","type":"composite"},{"id":226,"label":"Lien vers un outil","type":"sakai_entity"}],"100":[{"id":217,"label":"Texte","type":"text"},{"id":218,"label":"Document","type":"document"},{"id":219,"label":"Hyperlien","type":"url"},{"id":220,"label":"Coordonnées","type":"composite"},{"id":221,"label":"Lien vers un outil","type":"sakai_entity"}],"49":[{"id":54,"label":"Coordonnée","type":"contact_info"}],"98":[{"id":207,"label":"Texte","type":"text"},{"id":208,"label":"Document","type":"document"},{"id":209,"label":"Hyperlien","type":"url"},{"id":210,"label":"Coordonnées","type":"composite"},{"id":211,"label":"Lien vers un outil","type":"sakai_entity"}],"48":[{"id":53,"label":"Coordonnée","type":"contact_info"}],"97":[{"id":176,"label":"Lien vers un outil","type":"sakai_entity"},{"id":174,"label":"Hyperlien","type":"url"},{"id":173,"label":"Document","type":"document"},{"id":172,"label":"Texte","type":"text"},{"id":175,"label":"Coordonnées","type":"composite"}],"96":[{"id":200,"label":"Coordonnées","type":"composite"},{"id":199,"label":"Hyperlien","type":"url"},{"id":198,"label":"Document","type":"document"},{"id":197,"label":"Texte","type":"text"},{"id":201,"label":"Lien vers un outil","type":"sakai_entity"}],"95":[{"id":195,"label":"Coordonnées","type":"composite"},{"id":196,"label":"Lien vers un outil","type":"sakai_entity"},{"id":194,"label":"Hyperlien","type":"url"},{"id":193,"label":"Document","type":"document"},{"id":192,"label":"Texte","type":"text"}],"94":[{"id":191,"label":"Lien vers un outil","type":"sakai_entity"},{"id":190,"label":"Coordonnées","type":"composite"},{"id":189,"label":"Hyperlien","type":"url"},{"id":188,"label":"Document","type":"document"},{"id":187,"label":"Texte","type":"text"}],"93":[{"id":185,"label":"Coordonnées","type":"composite"},{"id":186,"label":"Lien vers un outil","type":"sakai_entity"},{"id":184,"label":"Hyperlien","type":"url"},{"id":183,"label":"Document","type":"document"},{"id":182,"label":"Texte","type":"text"}],"47":[{"id":52,"label":"Coordonnée","type":"contact_info"}],"92":[{"id":177,"label":"Texte","type":"text"},{"id":178,"label":"Document","type":"document"},{"id":179,"label":"Hyperlien","type":"url"},{"id":181,"label":"Lien vers un outil","type":"sakai_entity"},{"id":180,"label":"Coordonnées","type":"composite"}],"46":[{"id":51,"label":"Coordonnée","type":"contact_info"}],"91":[{"id":145,"label":"Coordonnées","type":"composite"},{"id":144,"label":"Hyperlien","type":"url"},{"id":143,"label":"Document","type":"document"},{"id":142,"label":"Texte","type":"text"},{"id":146,"label":"Lien vers un outil","type":"sakai_entity"}],"90":[{"id":170,"label":"Coordonnées","type":"composite"},{"id":171,"label":"Lien vers un outil","type":"sakai_entity"},{"id":169,"label":"Hyperlien","type":"url"},{"id":168,"label":"Document","type":"document"},{"id":167,"label":"Texte","type":"text"}],"10":[{"id":68,"label":"Texte","type":"text"},{"id":69,"label":"Document","type":"document"},{"id":70,"label":"Hyperlien","type":"url"},{"id":71,"label":"Référence bibliographique","type":"citation"}],"88":[{"id":160,"label":"Coordonnées","type":"composite"},{"id":161,"label":"Lien vers un outil","type":"sakai_entity"},{"id":159,"label":"Hyperlien","type":"url"},{"id":158,"label":"Document","type":"document"},{"id":157,"label":"Texte","type":"text"}],"89":[{"id":166,"label":"Lien vers un outil","type":"sakai_entity"},{"id":165,"label":"Coordonnées","type":"composite"},{"id":164,"label":"Hyperlien","type":"url"},{"id":163,"label":"Document","type":"document"},{"id":162,"label":"Texte","type":"text"}]};
        SyllabusService.setTemplate(template);    
        // select first item
        if (syllabus.elements.length > 0 ) {
            syllabus.elements[0].$selected = true;
            TreeService.setSelectedItem(syllabus.elements[0], true);  
        }
        // mockup ressources
        var ressources = {"entityPrefix":"content","content_collection":[{"created":1442952457719,"creator":"e7c75c5e-5439-47bd-9561-64f742ef30a4","description":null,"hidden":false,"mimeType":null,"modified":1442952457788,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"52-701-02A.A2013.P3","priority":"12101","properties":{},"reference":"/content/group/52-701-02A.A2013.P3/","resourceChildren":[{"created":1449523584090,"creator":"e7c75c5e-5439-47bd-9561-64f742ef30a4","description":"","hidden":false,"mimeType":null,"modified":1449523584120,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"poster","priority":"6","properties":{"http://purl.org/dc/elements/1.1/publisher":"","http://ltsc.ieee.org/xsd/lomv1.0/assumed_knowledge":"","http://ltsc.ieee.org/xsd/lomv1.0/review_date":"","http://ltsc.ieee.org/xsd/lomv1.0/role":"","http://ltsc.ieee.org/xsd/lomv1.0/engagement":"","http://purl.org/dc/terms/abstract":"","http://ltsc.ieee.org/xsd/lomv1.0/duration":"0--0-","SAKAI:conditionalrelease":"false","SAKAI:conditionalNotificationId":"","http://ltsc.ieee.org/xsd/lomv1.0/granularity_level":"","http://purl.org/dc/elements/1.1/contributor":"","http://purl.org/dc/terms/created":"","http://ltsc.ieee.org/xsd/lomv1.0/other_requirements":"","http://purl.org/dc/elements/1.1/alternative":"","http://ltsc.ieee.org/xsd/lomv1.0/relation":"","http://ltsc.ieee.org/xsd/lomv1.0/structure":"","http://ltsc.ieee.org/xsd/lomv1.0/status":"","http://purl.org/dc/terms/issued":"","http://ltsc.ieee.org/xsd/lomv1.0/interactivity_level":"","http://ltsc.ieee.org/xsd/lomv1.0/technical_requirements":"","http://purl.org/dc/terms/audience":"","http://ltsc.ieee.org/xsd/lomv1.0/install_remarks":"","http://purl.org/dc/elements/1.1/subject":"","http://ltsc.ieee.org/xsd/lomv1.0/reviewer":"","http://purl.org/dc/terms/educationLevel":"","http://ltsc.ieee.org/xsd/lomv1.0/context_level":"","http://ltsc.ieee.org/xsd/lomv1.0/review_comments":"","http://ltsc.ieee.org/xsd/lomv1.0/coverage":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_time":"0--0-","http://purl.org/dc/elements/1.1/creator":"","http://ltsc.ieee.org/xsd/lomv1.0/difficulty":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_resource_type":""},"reference":"/content/group/52-701-02A.A2013.P3/poster/","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/poster/","size":null,"type":"org.sakaiproject.content.types.folder","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/poster/"},{"created":1447346365055,"creator":"b8e0d624-40b4-418a-ad68-267f02661a02","description":"","hidden":false,"mimeType":null,"modified":1447346365082,"modifiedBy":"b8e0d624-40b4-418a-ad68-267f02661a02","name":"test","priority":"4","properties":{"http://purl.org/dc/elements/1.1/publisher":"","http://ltsc.ieee.org/xsd/lomv1.0/assumed_knowledge":"","http://ltsc.ieee.org/xsd/lomv1.0/review_date":"","http://ltsc.ieee.org/xsd/lomv1.0/role":"","http://ltsc.ieee.org/xsd/lomv1.0/engagement":"","http://purl.org/dc/terms/abstract":"","http://ltsc.ieee.org/xsd/lomv1.0/duration":"0--0-","SAKAI:conditionalrelease":"false","SAKAI:conditionalNotificationId":"","http://ltsc.ieee.org/xsd/lomv1.0/granularity_level":"","http://purl.org/dc/elements/1.1/contributor":"","http://purl.org/dc/terms/created":"","http://ltsc.ieee.org/xsd/lomv1.0/other_requirements":"","http://purl.org/dc/elements/1.1/alternative":"","http://ltsc.ieee.org/xsd/lomv1.0/relation":"","http://ltsc.ieee.org/xsd/lomv1.0/structure":"","http://ltsc.ieee.org/xsd/lomv1.0/status":"","http://purl.org/dc/terms/issued":"","http://ltsc.ieee.org/xsd/lomv1.0/interactivity_level":"","http://ltsc.ieee.org/xsd/lomv1.0/technical_requirements":"","http://purl.org/dc/terms/audience":"","http://ltsc.ieee.org/xsd/lomv1.0/install_remarks":"","http://purl.org/dc/elements/1.1/subject":"","http://ltsc.ieee.org/xsd/lomv1.0/reviewer":"","http://purl.org/dc/terms/educationLevel":"","http://ltsc.ieee.org/xsd/lomv1.0/context_level":"","http://ltsc.ieee.org/xsd/lomv1.0/review_comments":"","http://ltsc.ieee.org/xsd/lomv1.0/coverage":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_time":"0--0-","http://purl.org/dc/elements/1.1/creator":"","http://ltsc.ieee.org/xsd/lomv1.0/difficulty":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_resource_type":""},"reference":"/content/group/52-701-02A.A2013.P3/test/","resourceChildren":[{"created":1447346381202,"creator":"b8e0d624-40b4-418a-ad68-267f02661a02","description":null,"hidden":false,"mimeType":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","modified":1447346381327,"modifiedBy":"b8e0d624-40b4-418a-ad68-267f02661a02","name":"AF-ZCII-1936 -Bibliographie.docx","priority":"268435457","properties":{},"reference":"/content/group/52-701-02A.A2013.P3/test/AF-ZCII-1936 -Bibliographie.docx","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/test/AF-ZCII-1936 -Bibliographie.docx","size":"30670","type":"org.sakaiproject.content.types.fileUpload","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/test/AF-ZCII-1936%20-Bibliographie.docx"}],"resourceId":"/group/52-701-02A.A2013.P3/test/","size":null,"type":"org.sakaiproject.content.types.folder","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/test/"},{"created":1447346196558,"creator":"b8e0d624-40b4-418a-ad68-267f02661a02","description":"","hidden":false,"mimeType":"application/x-javascript","modified":1450368433341,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"angular.min (1).js","priority":"268435458","properties":{"http://purl.org/dc/elements/1.1/publisher":"","http://ltsc.ieee.org/xsd/lomv1.0/assumed_knowledge":"","CHEF:copyrightchoice":"I hold copyright.","http://ltsc.ieee.org/xsd/lomv1.0/review_date":"","http://ltsc.ieee.org/xsd/lomv1.0/role":"","http://ltsc.ieee.org/xsd/lomv1.0/engagement":"","http://purl.org/dc/terms/abstract":"","http://ltsc.ieee.org/xsd/lomv1.0/duration":"0--0-","SAKAI:conditionalrelease":"false","SAKAI:conditionalNotificationId":"","http://ltsc.ieee.org/xsd/lomv1.0/granularity_level":"","http://purl.org/dc/elements/1.1/contributor":"","SAKAI:allow_inline":"false","http://purl.org/dc/terms/created":"","http://ltsc.ieee.org/xsd/lomv1.0/other_requirements":"","http://purl.org/dc/elements/1.1/alternative":"","http://ltsc.ieee.org/xsd/lomv1.0/relation":"","http://ltsc.ieee.org/xsd/lomv1.0/structure":"","http://ltsc.ieee.org/xsd/lomv1.0/status":"","http://purl.org/dc/terms/issued":"","http://ltsc.ieee.org/xsd/lomv1.0/interactivity_level":"","http://ltsc.ieee.org/xsd/lomv1.0/technical_requirements":"","http://purl.org/dc/terms/audience":"","http://ltsc.ieee.org/xsd/lomv1.0/install_remarks":"","http://purl.org/dc/elements/1.1/subject":"","http://ltsc.ieee.org/xsd/lomv1.0/reviewer":"","http://purl.org/dc/terms/educationLevel":"","http://ltsc.ieee.org/xsd/lomv1.0/context_level":"","http://ltsc.ieee.org/xsd/lomv1.0/review_comments":"","http://ltsc.ieee.org/xsd/lomv1.0/coverage":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_time":"0--0-","http://purl.org/dc/elements/1.1/creator":"","http://ltsc.ieee.org/xsd/lomv1.0/difficulty":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_resource_type":""},"reference":"/content/group/52-701-02A.A2013.P3/angular.min _1_.js","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/angular.min _1_.js","size":"146836","type":"org.sakaiproject.content.types.fileUpload","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/angular.min%20_1_.js"},{"created":1448477096431,"creator":"0e4665ce-27c0-40b8-8f20-c9305636d494","description":"","hidden":false,"mimeType":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","modified":1450368443474,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"Book1.xlsx","priority":"268435461","properties":{"http://purl.org/dc/elements/1.1/publisher":"","http://ltsc.ieee.org/xsd/lomv1.0/assumed_knowledge":"","CHEF:copyrightchoice":"I hold copyright.","http://ltsc.ieee.org/xsd/lomv1.0/review_date":"","http://ltsc.ieee.org/xsd/lomv1.0/role":"","http://ltsc.ieee.org/xsd/lomv1.0/engagement":"","http://purl.org/dc/terms/abstract":"","http://ltsc.ieee.org/xsd/lomv1.0/duration":"0--0-","SAKAI:conditionalrelease":"false","SAKAI:conditionalNotificationId":"","http://ltsc.ieee.org/xsd/lomv1.0/granularity_level":"","http://purl.org/dc/elements/1.1/contributor":"","SAKAI:allow_inline":"false","http://purl.org/dc/terms/created":"","http://ltsc.ieee.org/xsd/lomv1.0/other_requirements":"","http://purl.org/dc/elements/1.1/alternative":"","http://ltsc.ieee.org/xsd/lomv1.0/relation":"","http://ltsc.ieee.org/xsd/lomv1.0/structure":"","http://ltsc.ieee.org/xsd/lomv1.0/status":"","http://purl.org/dc/terms/issued":"","http://ltsc.ieee.org/xsd/lomv1.0/interactivity_level":"","CHEF:copyrightalert":"true","http://ltsc.ieee.org/xsd/lomv1.0/technical_requirements":"","http://purl.org/dc/terms/audience":"","http://ltsc.ieee.org/xsd/lomv1.0/install_remarks":"","http://purl.org/dc/elements/1.1/subject":"","http://ltsc.ieee.org/xsd/lomv1.0/reviewer":"","http://purl.org/dc/terms/educationLevel":"","http://ltsc.ieee.org/xsd/lomv1.0/context_level":"","http://ltsc.ieee.org/xsd/lomv1.0/review_comments":"","http://ltsc.ieee.org/xsd/lomv1.0/coverage":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_time":"0--0-","http://purl.org/dc/elements/1.1/creator":"","http://ltsc.ieee.org/xsd/lomv1.0/difficulty":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_resource_type":""},"reference":"/content/group/52-701-02A.A2013.P3/Book1.xlsx","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/Book1.xlsx","size":"8014","type":"org.sakaiproject.content.types.fileUpload","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/Book1.xlsx"},{"created":1450301000675,"creator":"b8e0d624-40b4-418a-ad68-267f02661a02","description":null,"hidden":false,"mimeType":"image/jpeg","modified":1450301000798,"modifiedBy":"b8e0d624-40b4-418a-ad68-267f02661a02","name":"Desert.jpg","priority":"268435463","properties":{},"reference":"/content/group/52-701-02A.A2013.P3/Desert.jpg","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/Desert.jpg","size":"845941","type":"org.sakaiproject.content.types.fileUpload","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/Desert.jpg"},{"created":1450301134898,"creator":"b8e0d624-40b4-418a-ad68-267f02661a02","description":"","hidden":false,"mimeType":"image/jpeg","modified":1450368812507,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"Hydrangeas.jpg","priority":"268435464","properties":{"http://purl.org/dc/elements/1.1/publisher":"","http://ltsc.ieee.org/xsd/lomv1.0/assumed_knowledge":"","CHEF:copyrightchoice":"Material is in public domain.","http://ltsc.ieee.org/xsd/lomv1.0/review_date":"","http://ltsc.ieee.org/xsd/lomv1.0/role":"","http://ltsc.ieee.org/xsd/lomv1.0/engagement":"","http://purl.org/dc/terms/abstract":"","http://ltsc.ieee.org/xsd/lomv1.0/duration":"0--0-","SAKAI:conditionalrelease":"false","SAKAI:conditionalNotificationId":"","http://ltsc.ieee.org/xsd/lomv1.0/granularity_level":"","http://purl.org/dc/elements/1.1/contributor":"","SAKAI:allow_inline":"false","http://purl.org/dc/terms/created":"","http://ltsc.ieee.org/xsd/lomv1.0/other_requirements":"","http://purl.org/dc/elements/1.1/alternative":"","http://ltsc.ieee.org/xsd/lomv1.0/relation":"","http://ltsc.ieee.org/xsd/lomv1.0/structure":"","http://ltsc.ieee.org/xsd/lomv1.0/status":"","http://purl.org/dc/terms/issued":"","http://ltsc.ieee.org/xsd/lomv1.0/interactivity_level":"","http://ltsc.ieee.org/xsd/lomv1.0/technical_requirements":"","http://purl.org/dc/terms/audience":"","http://ltsc.ieee.org/xsd/lomv1.0/install_remarks":"","http://purl.org/dc/elements/1.1/subject":"","http://ltsc.ieee.org/xsd/lomv1.0/reviewer":"","http://purl.org/dc/terms/educationLevel":"","http://ltsc.ieee.org/xsd/lomv1.0/context_level":"","http://ltsc.ieee.org/xsd/lomv1.0/review_comments":"","http://ltsc.ieee.org/xsd/lomv1.0/coverage":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_time":"0--0-","http://purl.org/dc/elements/1.1/creator":"","http://ltsc.ieee.org/xsd/lomv1.0/difficulty":"","http://ltsc.ieee.org/xsd/lomv1.0/learning_resource_type":""},"reference":"/content/group/52-701-02A.A2013.P3/Hydrangeas.jpg","release":1450368000000,"resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/Hydrangeas.jpg","retract":1451491200000,"size":"595284","type":"org.sakaiproject.content.types.fileUpload","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/Hydrangeas.jpg"},{"created":1446841004485,"creator":"e7c75c5e-5439-47bd-9561-64f742ef30a4","description":null,"hidden":false,"mimeType":"text/html","modified":1446841005833,"modifiedBy":"e7c75c5e-5439-47bd-9561-64f742ef30a4","name":"Nouvelle liste de références","priority":"268435457","properties":{"sakai:reference-root":"/citation","citations.temporary_citation_list":"true"},"reference":"/citation/content/group/52-701-02A.A2013.P3/Nouvelle liste de références","resourceChildren":[],"resourceId":"/group/52-701-02A.A2013.P3/Nouvelle liste de références","size":"36","type":"org.sakaiproject.citation.impl.CitationList","url":"http://localhost:8080/access/citation/content/group/52-701-02A.A2013.P3/Nouvelle%20liste%20de%20r%C3%A9f%C3%A9rences"}],"resourceId":"/group/52-701-02A.A2013.P3/","size":null,"type":"org.sakaiproject.content.types.folder","url":"http://localhost:8080/access/content/group/52-701-02A.A2013.P3/","entityReference":"/content","entityURL":"http://localhost:8080/direct/content"}]};
        ResourcesService.setResources(ressources.content_collection[0]);
        $rootScope.$broadcast('RESOURCES_LOADED');

        SyllabusService.working = false;
        $scope.infos.working = false; 

    } else {
        // MODE CONNECTE
        // show loader
        console.log('start');
        console.time('xhr');
        $scope.infos.working = true;
    	//var results = SyllabusService.getSyllabus();
        var results = SyllabusService.loadSyllabus();
        var resultsTemplate = SyllabusService.loadTemplate();


        // console.log(results);

        var loadSyllabusAndTemplate = function(){
        	return $q.allSettled([results.$promise, resultsTemplate.$promise]).then( function(data) {

                // data contient d'abord le résultat de la première requête
                if (data[0].state === "fulfilled") {
                    SyllabusService.setSyllabus(data[0].value);
                    // Masquer les items du menu sur mobile
                    SyllabusService.hideItemsInit();
   
                    // $scope.planLoaded = true;
                } else if (data[0].state === "rejected") {
                    if (data[0].reason.status === 404) {
                        // load le contenu de la réponse avec statut 404: c'est un plan de cours vide
                        SyllabusService.setSyllabus(data[0].reason.data);
                    } else {
                        $scope.planFailed= true;
                    }
                }

                if (data[1].state === "fulfilled") {
                    // MOCKUP template
                    // var template = {"114":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"115":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"112":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"113":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"110":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"111":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"35":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"82":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"83":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"80":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"81":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"86":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"87":[{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"84":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"85":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"}],"3":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"}],"2":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"}],"1":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Approche pédagogique","type":"rubric"}],"7":[{"label":"Ressources bibliographiques","type":"rubric"},{"label":"Ressources bibliographiques complémentaire","type":"rubric"},{"label":"Ressources générales","type":"rubric"},{"label":"Cas","type":"rubric"},{"label":"Outils","type":"rubric"},{"label":"Anciens examens","type":"rubric"}],"6":[{"label":"Coordonnée","type":"contact_info"}],"5":[{"label":"Coordonnateur","type":"rubric"},{"label":"Enseignant(s)","type":"rubric"},{"label":"Stagiaire(s) d'enseignement","type":"rubric"},{"label":"Conférencier(s)","type":"rubric"},{"label":"Secrétaire(s)","type":"rubric"}],"4":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"}],"9":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"8":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"19":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"}],"55":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"17":[{"label":"Séance de cours","type":"lecture"},{"label":"Séance de travaux pratique","type":"tutorial"}],"18":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"}],"15":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"},{"label":"Lien vers un outil","type":"sakai_entity"}],"16":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"},{"label":"Lien vers un outil","type":"sakai_entity"}],"13":[{"label":"Description","type":"rubric"},{"label":"Objectifs","type":"rubric"},{"label":"Critère d'évaluation","type":"rubric"},{"label":"Préparation à l'évaluation","type":"rubric"},{"label":"Modalités de remise et pénalités","type":"rubric"},{"label":"Ressources générales","type":"rubric"}],"14":[{"label":"Regroupement","type":"composite"},{"label":"Séance de cours","type":"lecture"},{"label":"Séance de travaux pratique","type":"tutorial"}],"11":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"12":[{"label":"Examen intra","type":"evaluation"},{"label":"Examen final","type":"evaluation"},{"label":"Travail","type":"evaluation"},{"label":"Participation","type":"evaluation"},{"label":"Test/Quiz","type":"evaluation"},{"label":"Autre","type":"evaluation"}],"21":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"}],"20":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"}],"109":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"108":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"107":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"106":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"105":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"104":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"103":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"99":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"102":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"101":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"100":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"49":[{"label":"Coordonnée","type":"contact_info"}],"98":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"}],"48":[{"label":"Coordonnée","type":"contact_info"}],"97":[{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"},{"label":"Coordonnées","type":"composite"}],"96":[{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"},{"label":"Lien vers un outil","type":"sakai_entity"}],"95":[{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"94":[{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"93":[{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"47":[{"label":"Coordonnée","type":"contact_info"}],"92":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"}],"46":[{"label":"Coordonnée","type":"contact_info"}],"91":[{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"},{"label":"Lien vers un outil","type":"sakai_entity"}],"90":[{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"10":[{"label":"Texte","type":"text"},{"label":"Document","type":"document"},{"label":"Hyperlien","type":"url"},{"label":"Référence bibliographique","type":"citation"}],"88":[{"label":"Coordonnées","type":"composite"},{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}],"89":[{"label":"Lien vers un outil","type":"sakai_entity"},{"label":"Coordonnées","type":"composite"},{"label":"Hyperlien","type":"url"},{"label":"Document","type":"document"},{"label":"Texte","type":"text"}]};          
                    SyllabusService.setTemplate(data[1].value);
                    // $scope.templateLoaded = true;
                } else if (data[1].state === "rejected") {
                    $scope.templateFailed = true;
                }
         
                   
                   
                if ( !$scope.planFailed ) {
                    // sélection du premier élément par défaut (attention : après chargement du plan de cours + template)
                    if (SyllabusService.syllabus.elements.length > 0 ) {
                        // data[0].value.elements[0].selected = true;
                        TreeService.setSelectedItem(SyllabusService.syllabus.elements[0], true);
                    }

                    // TEST INTERVAL SAUVEGARDE PLAN DE COURS
                    // SyllabusService.startUpdateProcess(5000);
                    // $interval( $scope.updateSyllabus, 5000);

                    $timeout(function() {
                        // anything you want can go here and will safely be run on the next digest.
                        // resize frame (should be done also whenever we change content)
                        if (window.frameElement) {
                            setMainFrameHeight(window.frameElement.id);
                        }
                    });
                }


        	}, function(error) {
                console.log('erreur get syllabus');

       	    });
        };

      var loadSakaiTools = function(){
        return SakaiToolsService.loadToolEntities(SyllabusService.syllabus.siteId).$promise.then(function($data){
               $rootScope.$broadcast('TOOLS_LOADED');
               SakaiToolsService.setToolsEntities($data);
            }, function($error){
                // erreur load resources
        });
      };
        
      var loadResources = function (){
        	return ResourcesService.loadResources(SyllabusService.syllabus.siteId).$promise.then(function($data){
                ResourcesService.setResources($data.content_collection[0]);

                $rootScope.$broadcast('RESOURCES_LOADED');

                // $rootScope.Scope.$countWatchers();
            }, function($error){
                // erreur load resources
            });
        };
        
        var loadCitations = function(){
            var citationsLists =  CitationsService.getCitationLists(ResourcesService.resources);
            return $q.allSettled(citationsLists.promises).then( function(data) {
                var updatedResource, updatedResourceId;
                for (var i = 0 ; i < data.length ; i++) {
                    // data contient d'abord le résultat de la première requête
                    if (data[i].state === "fulfilled") {
                       updatedResourceId = citationsLists.resourceIds[i];
                       updatedResource = ResourcesService.getResource(updatedResourceId);

                       updatedResource.resourceChildren = CitationsService.updateJsonProperties(updatedResourceId, data[i].value.citations);
                          
                             
                    } else if (data[i].state === "rejected") {
                        //TODO: Voir si on veut mettre plus d'informations sur le message d'erreur
                        $rootScope.$broadcast('CITATIONS_NOT_LOADED');
                    }
                }

            }, function(error) {
                console.log('erreur get citations');

            });
        };

   
      // Chargement du plan de cours et du template, puis des ressources
        loadSyllabusAndTemplate()
    	.then(loadResources)
        .then(loadCitations)
        .then(loadSakaiTools)
    	.finally(function(){
             console.dir(ResourcesService.resources);
            $scope.infos.working = false;   		
        });

    }


    $scope.updateSyllabus = function() {

        if (SyllabusService.isDirty()) {
            // parcours des éléments de premier niveau pour voir lesquels sont en brouillon
            for (var i = 0; i < $scope.syllabusService.syllabus.elements.length ; i++ ) {
                var element = $scope.syllabusService.syllabus.elements[i];
                var elementSaved = $scope.syllabusService.syllabusSaved.elements[i];
                if (!angular.equals(element, elementSaved)){
                    console.log("élément : " + element.title);
                    // lancer sauvegarde
                }
            }

        }
    };

    $scope.save = function() {
        
        var results = SyllabusService.saveSyllabus();        
        SyllabusService.setWorking(true);
        // var selectedItemId = TreeService.selectedItem.id;
        var emplacement = TreeService.selectedItem.$emplacement;

        results.$promise.then( function($data) {
            AlertService.display('success', $translate.instant('ALERT_SUCCESS_ADD_ELEMENT'));
            SyllabusService.setSyllabus($data);
             // refresh the reference of the selected item and refresh the right panel
            // TreeService.setSelectedItemFromId(selectedItemId);
            TreeService.setSelectedItemFromEmplacement(emplacement);
        },
        function($error) {
            AlertService.display('danger');
        }).finally( function() {
            SyllabusService.setWorking(false);
        });

    };

    $scope.selectSection = function($section) {

        var results = SyllabusService.loadSyllabus();   
        SyllabusService.setWorking(true);

        results.$promise.then( function($data) {
            $scope.syllabusService.section = $section;

            SyllabusService.setSyllabus($data);

            // sélection du premier élément par défaut (attention : après chargement du plan de cours + template)
            if ($data.elements.length > 0 ) {
                // data[0].value.elements[0].selected = true;
                TreeService.setSelectedItem($data.elements[0], true);
            }

            // TEST INTERVAL SAUVEGARDE PLAN DE COURS
            // SyllabusService.startUpdateProcess(5000);
            // $interval( $scope.updateSyllabus, 5000);

            $timeout(function() {
                // anything you want can go here and will safely be run on the next digest.
                // resize frame (should be done also whenever we change content)
                if (window.frameElement) {
                    setMainFrameHeight(window.frameElement.id);
                }
            });
        },
        function($error) {
            AlertService.display('danger');
        }).finally( function() {
            SyllabusService.setWorking(false);
        });

    };


}]);
