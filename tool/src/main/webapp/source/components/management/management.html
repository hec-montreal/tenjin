<div data-ng-controller="ManagementCtrl" class="management">
	<div class="main-errors">
		<uib-alert data-ng-if="alertService.isVisible('danger')" class="myalert" type="danger" close="alertService.closeAlert('danger')" dismiss-on-timeout="5000">{{alertService.getAlertMsg('danger')}}</uib-alert>
	<uib-alert data-ng-if="alertService.isVisible('success')" class="myalert" type="success" close="alertService.closeAlert('success')" dismiss-on-timeout="5000">{{alertService.getAlertMsg('success')}}</uib<-alert>
	</div>
	<div class="buttons-list">
		<!-- CREATE -->
		<is-allowed data-permission="config.userProfileViews[3]">
			<button class="btn btn-primary" type="button" data-ng-click="addSyllabus()">{{ 'BUTTON_CREATE_SYLLABUS' | translate }}</button>
		</is-allowed>
		<is-allowed data-permission="config.userProfileViews[3]">
			<button class="btn btn-primary" type="button" data-ng-disabled="disableDelete" data-ng-click="deleteSyllabus()">{{ 'BUTTON_DELETE_SYLLABUS' | translate }}</button>
		</is-allowed>
	</div>

	<div>
		<table>
			<tr>
				<th>{{ 'TABLE_NAME' | translate }}  </th>
				<th>{{ 'TABLE_AUTHOR' | translate }}</th>
				<th>{{ 'TABLE_SECTIONS' | translate }}</th>
				<th>{{ 'TABLE_LAST_PUBLISHED_DATE' | translate }}</th>
				<th>{{ 'TABLE_LAST_MODIFICATION_DATE' | translate }}</th>
				<th class="th-select"> </th>
			</tr>
			<tr data-ng-repeat="syllabus in syllabusService.getSyllabusList()">
				<td>
			<a class="action" data-ng-if="userService.canEditSyllabusTitle(syllabus)" editable-text="syllabus.title" onbeforesave="updateTitle($data, syllabus)"><span class="glyphicon glyphicon-pencil"></span></a>
					<a ui-sref="syllabus-edit({ id: syllabus.id })">{{syllabus.title}}</a>
					
				</td>
				<td>
					{{syllabus.createdByName}}
				</td>
				<td>
					<!-- if common syllabus and no write permission on site -->
					<span data-ng-if="!userService.canEditSyllabusSection(syllabus)">
						{{ showSections(syllabus) }}
					</span>
					<!-- if not common syllabus or common syllabus with write permissions -->
					<a data-ng-if="userService.canEditSyllabusSection(syllabus)" href="" editable-checklist="syllabus.sections" e-ng-options="s.id as s.name for s in userSections" onbeforesave="updateSections($data, syllabus)" onaftersave="updateSyllabusList(syllabus)">
						{{ showSections(syllabus) }}
					</a>
				</td>
				<td>
					<span data-ng-if="syllabus.publishedDate">
						{{syllabus.publishedDate | date: 'medium'}}
					</span>

					<span data-ng-if="!syllabus.publishedDate">
						{{ 'DRAFTED_SYLLABUS' | translate }}
					</span>	
				</td>
				<td>
					<span data-ng-if="syllabus.lastModifiedDate">
						{{syllabus.lastModifiedDate | date: 'medium'}}
					</span>
				</td>

				<td class="th-select">
					<input data-ng-if="!syllabus.common" type="checkbox" name="syllabus.id" data-ng-model="syllabus.checked" data-ng-click="managementCtrl.enableDelete()" />
				</td> 
			</tr>
		</table>
	</div>
</div>
